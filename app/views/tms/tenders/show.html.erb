<div class="mx-auto px-6 w-full sm:px-16 lg:w-3/4 xl:w-7/12">
  <h1 class="text-2xl lg:text-3xl xl:text-4xl mb-1 text-zinc-900">
    <%= @tender.title %>
  </h1>

  <h2 class="font-mono text-xs lg:text-sm mb-1 xl:mb-2 text-zinc-500">
    <%= @tender.reference_token %>
  </h2>

  <div class="inline-flex mb-4 xl:mb-6">
    <time class="block pt-0.5 lg:pt-0 text-xs lg:text-sm xl:text-base
                font-normal leading-none text-zinc-500">
      <%= @tender.opens_on.strftime("%d %b %Y, %H:%M") %>
    </time>

    <span class="inline-flex items-center justify-center text-slate-400 mx-1">
      &mdash;
    </span>

    <time class="block pt-0.5 lg:pt-0 text-xs lg:text-sm xl:text-base
                font-normal leading-none text-zinc-500">
      <%= @tender.closes_on.strftime("%d %b %Y, %H:%M") %>
    </time>
  </div>

  <div class="flex mb-8 xl:mb-12">
    <span class="bg-purple-100 text-purple-800 text-xs font-semibold mr-2
                 px-2.5 py-0.5 rounded capitalize">
      <%= @tender.publication_state %>
    </span>
    <span class="bg-purple-100 text-purple-800 text-xs font-semibold mr-2
                 px-2.5 py-0.5 rounded capitalize">
      <%= @tender.notice_state.titleize %>
    </span>
  </div>

  <div class="text-gray-800 mb-8">
    <h1 class="text-purple-500 font-semibold mb-1">
      Description
    </h1>
    <%= @tender.description %>
  </div>

  <% if @tender.reviewed? %>
    <div class="tender-selection bg-green-50 text-green-600 text-sm rounded-lg p-4 mb-8 xl:mb-12">
      <h2 class="mb-2">
      Awarded to 
      <span class="font-bold"><%= @tender.selection.bid.quotation_token %></span> 
      by <span class="font-bold"><%= @tender.selection.bid.name %></span>
      </h2>

      <h3 class="font-bold">
        Reason
      </h3>
      <p>
        <%= @tender.selection.reason %>
      </p>
    </div>
  <% end %>

  <%= turbo_frame_tag "tender-buttons-section" do %>
    <div class="flex mb-6">
      <% if policy([:tms, @tender]).edit? %>
        <%= link_to(
          "Edit",
          edit_tms_tender_path(@tender),
          target: "_top",
          class: "block btn btn--normal btn--purple w-32"
        )%>
      <% end %>

      <%= link_to(
        "Attachments",
        tms_tender_documents_path(@tender),
        target: "_top",
        class: "block btn btn--normal btn--purple w-32"
      )%>

      <% if TMS::PublicationPolicy.new(current_admin, @tender).update? %>
        <%= button_to(
          "Publish Tender",
          publish_tms_tender_path(@tender),
          method: :patch,
          params: {tender: {publication_state: "published"}},
          class: "mr-3 btn btn--normal btn--purple"
        )%>
      <% end %>
    </div>
  <% end %>

  <% if @tender.under_review? || @tender.reviewed? %>
    <%= render partial: "bids", locals: { tender: @tender } %>
  <% end %>
</div>
